<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    
    <title>Client</title>
    <link rel="stylesheet" href="index.css">
</head>
<body>

    <img id="logo" src= "./pictures/logo.png">

    <form id="loginform">
        <h1>Login</h1>
        <label for="loginUsername">Username: </label>
        <input name="Username" id="loginUsername" type="text" value="test" />

        <label for="loginPsw">Password: </label>
        <input name="psw" id="loginPsw" type="password" value="aaa" />

        <input type="submit" value="Login">

    </form>
    
    <form id="createform">
        <h1>Create Account</h1>
        <label for="createUsername">Username: </label>
        <input name="Username" id="createUsername" type="text" value="test" />

        <label for="createPsw">Password: </label>
        <input name="psw" id="createPsw" type="password" value="aaa" />

        <label for="createPswConf">Confirm Password: </label>
        <input name="psw" id="createPswConf" type="password" value="aaa" />

        <input type="submit" value="Create Account">

     
    </form>

    
</body>



<script>    

    


    //login user

    const loginUser = document.getElementById("loginform");

    loginUser.addEventListener("submit", function(evt){
        
        evt.preventDefault();

        const loginUsername = document.getElementById("loginUsername").value;
        const loginPsw = document.getElementById("loginPsw").value;

        if(loginUsername !== "" && loginPsw !== ""){

        let username = loginUsername
        let password = loginPsw

       

        const credentials = "Basic " + window.btoa(`${username}:${password}`); //kryptert streng
        //const credentials = username + ":" + password; //til ren streng/tekst

        
        let config = {
            method: "GET",
            headers: {
            "content-type": "application/json",
            "authorization": credentials
            }
        }

        fetch("/user", config).then(resp => {
            //console.log(resp.status);
            //if test hvis login er successful
            test(resp);
        });

    }else{
        //return invalid username/password
    }

    })

    
    //


    //create User
    const userform = document.getElementById('createform');

    userform.addEventListener('submit', async function(evt) {

    evt.preventDefault();

    const createUsername = document.getElementById("createUsername").value;
    const createPassword = document.getElementById("createPsw").value;

    if(createUsername !== "" && createPassword !== ""){

    const createPasswordConf = document.getElementById("createPswConf").value;

    if(createPassword === createPasswordConf){

            let body = {
                username: createUsername,
                password: createPassword
            }
            let config = {
                method: "POST",
                headers: {
                    "content-type": "application/json"
                },
                body: JSON.stringify(body)
            }

            fetch("/user", config).then(resp => {
                //console.log(resp.status);
                //if test om create er successful
                test(resp);
                
            });

        }else{
            // div shows up with text
            let errorDiv = document.createElement("div")
            errorDiv.innerHTML = "Passwords don't match!";
            document.body.appendChild(errorDiv);

            
        }
    }else{
        //return invalid username/password
    }


    });
    
    
    //

    //

    function test(res){
        console.log(res.status);
        //location.href = "userIndex.html";
    }

    //
    
    
</script>

</html>
