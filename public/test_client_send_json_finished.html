<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    
    <title>My document</title>
</head>
<body>

    <label id="btnFile" for="inpFile">Select file
        <img id="btnImg" >
    </label>    
    
    <input id="inpFile" type="file" accept="image/*" />
    <button id="btnSend">Send data</button>   
    
</body>

<script>

    let btnImg = document.getElementById('btnImg');
    let inpFile = document.getElementById('inpFile');
    let btnSend = document.getElementById('btnSend');

    let imgdata = "";
    
    //send data ---------------------------------------
    btnSend.addEventListener('click', async function(evt) {
        
        let url = "http://localhost:3000";

        let updata = {
            img: imgdata
        }

        let cfg = {
            method: "POST",
            headers: {"content-type": "application/json"},
            body: JSON.stringify(updata)
        }

        let response = await fetch(url, cfg);
        let data = await response.text();
        console.log(data);

    });
    
    //select and handle image -------------------------
    inpFile.addEventListener('change', function(evt) {

        let file = inpFile.files[0];        

        if (file.type != "image/png" && file.type != "image/jpeg") {
            console.log("wrong filetype");
            return;
        }

        if (file.size > 1000000) {
            console.log("the file is too large");
            return;
        }

        let freader = new FileReader();
        freader.addEventListener('load', function(evt) {
            btnImg.src = freader.result;
            imgdata = freader.result;
        });
        freader.readAsDataURL(file);
    });

</script>




<style>

    * {
        box-sizing: border-box;
        font-family: sans-serif;
        font-size: 12pt;
    }

    #inpFile {
        display: none;
    }

    #btnFile {
        padding: 4px;
        display: inline-block;
        width: 200px; height: 100px;
        border: 1px solid darkgrey;
        border-radius: 10px;
        background-color: azure;
    }

    #btnFile>img {
        display: block;
        width: 60px;
        height: 60px;
        margin: 5px;
    }

</style>

</html>